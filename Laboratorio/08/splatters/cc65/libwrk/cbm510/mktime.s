;
; File generated by cc65 v 2.17 - Git 582aa41
;
	.fopt		compiler,"cc65 v 2.17 - Git 582aa41"
	.setcpu		"6502"
	.smart		on
	.autoimport	on
	.case		on
	.debuginfo	off
	.importzp	sp, sreg, regsave, regbank
	.importzp	tmp1, tmp2, tmp3, tmp4, ptr1, ptr2, ptr3, ptr4
	.macpack	longbranch
	.import		_div
	.import		__tz
	.export		_mktime

.segment	"RODATA"

_MonthLength:
	.byte	$1F
	.byte	$1C
	.byte	$1F
	.byte	$1E
	.byte	$1F
	.byte	$1E
	.byte	$1F
	.byte	$1F
	.byte	$1E
	.byte	$1F
	.byte	$1E
	.byte	$1F
_MonthDays:
	.word	$0000
	.word	$001F
	.word	$003B
	.word	$005A
	.word	$0078
	.word	$0097
	.word	$00B5
	.word	$00D4
	.word	$00F3
	.word	$0111
	.word	$0130
	.word	$014E

; ---------------------------------------------------------------
; unsigned long __near__ __fastcall__ mktime (register __near__ struct tm *)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_mktime: near

.segment	"RODATA"

L002F:
	.word	$0000
L0038:
	.word	$0000
L0043:
	.word	$0000
L004E:
	.word	$0000
L005D:
	.word	$0000

.segment	"CODE"

	jsr     pushax
	ldy     #$00
	ldx     #$04
	jsr     regswap2
	jsr     decsp4
	ldy     #$03
L002A:	lda     regbank-1,x
	sta     (sp),y
	dey
	dex
	bne     L002A
	jsr     decsp4
	lda     regbank+4
	ora     regbank+4+1
	jeq     L002E
	ldy     #$01
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	jsr     pushax
	ldx     #$00
	lda     #$3C
	jsr     _div
	sta     regbank+0
	stx     regbank+0+1
	ldy     sreg
	sty     regbank+0+2
	ldy     sreg+1
	sty     regbank+0+3
	lda     regbank+0
	ldy     #$00
	sta     (regbank+4),y
	iny
	lda     regbank+0+1
	sta     (regbank+4),y
	ldy     #$03
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	clc
	adc     regbank+2
	txa
	adc     regbank+2+1
	tax
	cpx     #$80
	jcs     L002E
	lda     regbank+4
	ldx     regbank+4+1
	jsr     pushax
	ldy     #$03
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	clc
	adc     regbank+2
	pha
	txa
	adc     regbank+2+1
	tax
	pla
	jsr     staxspidx
	iny
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	jsr     pushax
	ldx     #$00
	lda     #$3C
	jsr     _div
	sta     regbank+0
	stx     regbank+0+1
	ldy     sreg
	sty     regbank+0+2
	ldy     sreg+1
	sty     regbank+0+3
	lda     regbank+0
	ldy     #$02
	sta     (regbank+4),y
	iny
	lda     regbank+0+1
	sta     (regbank+4),y
	ldy     #$05
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	clc
	adc     regbank+2
	txa
	adc     regbank+2+1
	tax
	cpx     #$80
	jcs     L002E
	lda     regbank+4
	ldx     regbank+4+1
	jsr     pushax
	ldy     #$05
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	clc
	adc     regbank+2
	pha
	txa
	adc     regbank+2+1
	tax
	pla
	jsr     staxspidx
	iny
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	jsr     pushax
	ldx     #$00
	lda     #$18
	jsr     _div
	sta     regbank+0
	stx     regbank+0+1
	ldy     sreg
	sty     regbank+0+2
	ldy     sreg+1
	sty     regbank+0+3
	lda     regbank+0
	ldy     #$04
	sta     (regbank+4),y
	iny
	lda     regbank+0+1
	sta     (regbank+4),y
	ldy     #$07
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	clc
	adc     regbank+2
	txa
	adc     regbank+2+1
	tax
	cpx     #$80
	jcs     L002E
	lda     regbank+4
	ldx     regbank+4+1
	jsr     pushax
	ldy     #$07
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	clc
	adc     regbank+2
	pha
	txa
	adc     regbank+2+1
	tax
	pla
L0099:	jsr     staxspidx
	ldy     #$09
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	jsr     pushax
	ldx     #$00
	lda     #$0C
	jsr     _div
	sta     regbank+0
	stx     regbank+0+1
	ldy     sreg
	sty     regbank+0+2
	ldy     sreg+1
	sty     regbank+0+3
	lda     regbank+0
	ldy     #$08
	sta     (regbank+4),y
	iny
	lda     regbank+0+1
	sta     (regbank+4),y
	ldy     #$0B
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	clc
	adc     regbank+2
	txa
	adc     regbank+2+1
	tax
	cpx     #$80
	jcs     L002E
	lda     regbank+4
	ldx     regbank+4+1
	jsr     pushax
	ldy     #$0B
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	clc
	adc     regbank+2
	pha
	txa
	adc     regbank+2+1
	tax
	pla
	jsr     staxspidx
	dey
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	cpx     #$00
	bne     L0060
	cmp     #$01
	bne     L0060
	ldy     #$0B
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	sta     ptr1
	stx     ptr1+1
	lda     #$6C
	clc
	adc     ptr1
	pha
	lda     #$07
	adc     ptr1+1
	tax
	pla
	jsr     _IsLeapYear
	tax
	beq     L0060
	ldx     #$00
	lda     #$1D
	jmp     L009C
L0060:	ldy     #$09
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	sta     ptr1
	txa
	clc
	adc     #>(_MonthLength)
	sta     ptr1+1
	ldy     #<(_MonthLength)
	lda     (ptr1),y
	ldx     #$00
L009C:	ldy     #$02
	jsr     staxysp
	ldy     #$07
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	jsr     pushax
	ldy     #$05
	jsr     ldaxysp
	jsr     tosicmp
	bmi     L0052
	beq     L0052
	ldy     #$09
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	cpx     #$00
	bne     L006E
	cmp     #$0B
	bne     L006E
	txa
	sta     (regbank+4),y
	iny
	sta     (regbank+4),y
	ldy     #$0B
	lda     (regbank+4),y
	tax
	jmp     L00A3
L006E:	iny
	lda     (regbank+4),y
	tax
L00A3:	dey
	lda     (regbank+4),y
	jsr     incax1
	sta     (regbank+4),y
	iny
	txa
	sta     (regbank+4),y
	lda     regbank+4
	ldx     regbank+4+1
	jsr     pushax
	ldy     #$07
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	sec
	ldy     #$04
	sbc     (sp),y
	pha
	txa
	iny
	sbc     (sp),y
	tax
	pla
	iny
	jmp     L0099
L0052:	lda     regbank+4
	ldx     regbank+4+1
	jsr     pushax
	ldy     #$09
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	jsr     aslax1
	clc
	adc     #<(_MonthDays)
	tay
	txa
	adc     #>(_MonthDays)
	tax
	tya
	jsr     pushw
	ldy     #$07
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	jsr     tosaddax
	jsr     decax1
	ldy     #$0E
	jsr     staxspidx
	ldy     #$09
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	cmp     #$02
	txa
	sbc     #$00
	bvs     L007E
	eor     #$80
L007E:	bpl     L007C
	ldy     #$0B
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	sta     ptr1
	stx     ptr1+1
	lda     #$6C
	clc
	adc     ptr1
	pha
	lda     #$07
	adc     ptr1+1
	tax
	pla
	jsr     _IsLeapYear
	tax
	beq     L007C
	ldy     #$0F
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	jsr     incax1
	sta     (regbank+4),y
	iny
	txa
	sta     (regbank+4),y
L007C:	ldy     #$0B
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	ldy     #$46
	jsr     decaxy
	jsr     pushax
	ldx     #$01
	lda     #$6D
	jsr     tosumulax
	sta     ptr1
	stx     ptr1+1
	ldy     #$0B
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	ldy     #$45
	jsr     decaxy
	jsr     shrax2
	clc
	adc     ptr1
	pha
	txa
	adc     ptr1+1
	tax
	pla
	jsr     pushax
	ldy     #$0F
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	jsr     tosaddax
	jsr     stax0sp
	lda     regbank+4
	ldx     regbank+4+1
	jsr     pushax
	ldy     #$03
	jsr     ldaxysp
	jsr     incax4
	jsr     pushax
	lda     #$07
	jsr     tosumoda0
	ldy     #$0C
	jsr     staxspidx
	lda     regbank+4
	ldx     regbank+4+1
	jsr     pushax
	ldx     #$00
	txa
	ldy     #$10
	jsr     staxspidx
	jsr     ldax0sp
	jsr     axulong
	jsr     pusheax
	ldx     #$51
	lda     #$01
	sta     sreg
	lda     #$00
	sta     sreg+1
	lda     #$80
	jsr     tosumuleax
	jsr     pusheax
	ldy     #$05
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	jsr     axulong
	jsr     pusheax
	ldx     #$0E
	lda     #$10
	jsr     tosumul0ax
	jsr     tosaddeax
	jsr     pusheax
	ldy     #$03
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	jsr     pushax
	lda     #$3C
	jsr     tosumula0
	jsr     axulong
	jsr     tosaddeax
	jsr     pusheax
	ldy     #$01
	lda     (regbank+4),y
	tax
	dey
	lda     (regbank+4),y
	jsr     axulong
	jsr     tosaddeax
	jsr     pusheax
	lda     __tz+1+3
	sta     sreg+1
	lda     __tz+1+2
	sta     sreg
	ldx     __tz+1+1
	lda     __tz+1
	jsr     tossubeax
	jmp     L0029
L002E:	ldx     #$FF
	stx     sreg
	stx     sreg+1
	txa
L0029:	pha
	stx     tmp1
	ldy     #$09
	ldx     #$05
L0096:	lda     (sp),y
	sta     regbank+0,x
	dey
	dex
	bpl     L0096
	ldx     tmp1
	pla
	ldy     #$0A
	jmp     addysp

.endproc

; ---------------------------------------------------------------
; unsigned char __near__ __fastcall__ IsLeapYear (unsigned int)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_IsLeapYear: near

.segment	"CODE"

	jsr     pushax
	ldy     #$00
	lda     (sp),y
	ldx     #$00
	and     #$03
	bne     L00A4
	jsr     pushw0sp
	lda     #$64
	jsr     tosumoda0
	cpx     #$00
	bne     L0022
	cmp     #$00
	bne     L00A9
	jsr     pushw0sp
	ldx     #$01
	lda     #$90
	jsr     tosumodax
	cpx     #$00
	bne     L00A8
	cmp     #$00
	beq     L00A9
L00A8:	ldx     #$00
	txa
	jmp     incsp2
L0022:	ldx     #$00
L00A9:	lda     #$01
	jmp     incsp2
L00A4:	txa
	jmp     incsp2

.endproc

