;
; File generated by cc65 v 2.17 - Git 582aa41
;
	.fopt		compiler,"cc65 v 2.17 - Git 582aa41"
	.setcpu		"65SC02"
	.smart		on
	.autoimport	on
	.case		on
	.debuginfo	off
	.importzp	sp, sreg, regsave, regbank
	.importzp	tmp1, tmp2, tmp3, tmp4, ptr1, ptr2, ptr3, ptr4
	.macpack	longbranch
	.import		_isdigit
	.import		_islower
	.import		_isspace
	.import		_isupper
	.import		__seterrno
	.export		_strtoul

; ---------------------------------------------------------------
; unsigned long __near__ __fastcall__ strtoul (__near__ const unsigned char *, __near__ __near__ unsigned char * *, int)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_strtoul: near

.segment	"CODE"

	jsr     pushax
	lda     regbank+4
	ldx     regbank+5
	jsr     pushax
	ldy     #$07
	jsr     ldaxysp
	sta     regbank+4
	stx     regbank+4+1
	jsr     pushl0
	jsr     pusha
	jsr     pusha
	jsr     push0
	jsr     decsp6
	bra     L000A
L0008:	inc     regbank+4
	bne     L000A
	inc     regbank+4+1
L000A:	lda     (regbank+4)
	ldx     #$00
	jsr     _isspace
	stx     tmp1
	ora     tmp1
	bne     L0008
	lda     (regbank+4)
	cmp     #$2B
	beq     L0017
	cmp     #$2D
	bne     L0011
	lda     #$01
	ldy     #$09
	sta     (sp),y
L0017:	inc     regbank+4
	bne     L0011
	inc     regbank+4+1
L0011:	ldy     #$10
	lda     (sp),y
	iny
	ora     (sp),y
	bne     L0083
	tax
	lda     (regbank+4)
	cmp     #$30
	bne     L0082
	inc     regbank+4
	bne     L0020
	inc     regbank+4+1
L0020:	lda     (regbank+4)
	cmp     #$78
	beq     L0080
	cmp     #$58
	bne     L0081
L0080:	inc     regbank+4
	bne     L0025
	inc     regbank+4+1
L0025:	lda     #$10
	bra     L0094
L0081:	lda     #$08
	dey
	jsr     staxysp
	bra     L002F
L0082:	lda     #$0A
L0094:	dey
	jsr     staxysp
	bra     L002F
L0083:	lda     (sp),y
	bne     L002F
	dey
	lda     (sp),y
	cmp     #$10
	bne     L002F
	lda     (regbank+4)
	cmp     #$30
	bne     L002F
	ldy     #$01
	lda     (regbank+4),y
	cmp     #$78
	beq     L0088
	cmp     #$58
	bne     L002F
L0088:	lda     #$02
	clc
	adc     regbank+4
	sta     regbank+4
	bcc     L002F
	inc     regbank+4+1
L002F:	ldx     #$FF
	stx     sreg
	stx     sreg+1
	txa
	jsr     pusheax
	ldy     #$15
	jsr     ldaxysp
	jsr     axlong
	jsr     tosumodeax
	sta     (sp)
	ldx     #$FF
	stx     sreg
	stx     sreg+1
	txa
	jsr     pusheax
	ldy     #$15
	jsr     ldaxysp
	jsr     axlong
	jsr     tosudiveax
	ldy     #$01
	jsr     steaxysp
L003F:	lda     (regbank+4)
	ldx     #$00
	jsr     _isdigit
	stx     tmp1
	ora     tmp1
	beq     L0043
	ldx     #$00
	lda     (regbank+4)
	ldy     #$30
	bra     L0099
L0043:	lda     (regbank+4)
	ldx     #$00
	jsr     _isupper
	stx     tmp1
	ora     tmp1
	beq     L0049
	ldx     #$00
	lda     (regbank+4)
	ldy     #$37
	bra     L0099
L0049:	lda     (regbank+4)
	ldx     #$00
	jsr     _islower
	stx     tmp1
	ora     tmp1
	jeq     L0040
	ldx     #$00
	lda     (regbank+4)
	ldy     #$57
L0099:	jsr     decaxy
	ldy     #$05
	sta     (sp),y
	ldy     #$10
	cmp     (sp),y
	lda     #$00
	iny
	sbc     (sp),y
	bcs     L0040
	ldy     #$0D
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$08
	jsr     ldeaxysp
	jsr     tosugteax
	bne     L005A
	ldy     #$0D
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$08
	jsr     ldeaxysp
	jsr     toseqeax
	beq     L0059
	ldy     #$05
	lda     (sp),y
	sec
	sbc     (sp)
	sta     tmp1
	lda     tmp1
	beq     L0059
	bcc     L0059
L005A:	lda     #$01
	ldy     #$08
	sta     (sp),y
L0059:	ldy     #$08
	lda     (sp),y
	bne     L0061
	ldy     #$0D
	jsr     ldeaxysp
	jsr     pusheax
	ldy     #$15
	jsr     ldaxysp
	jsr     axlong
	jsr     tosumuleax
	jsr     pusheax
	ldy     #$09
	ldx     #$00
	lda     (sp),y
	jsr     axulong
	jsr     tosaddeax
	ldy     #$0A
	jsr     steaxysp
	ldy     #$06
	ldx     #$00
	lda     #$01
	jsr     addeqysp
L0061:	inc     regbank+4
	jne     L003F
	inc     regbank+4+1
	jmp     L003F
L0040:	ldy     #$13
	lda     (sp),y
	dey
	ora     (sp),y
	beq     L0070
	ldy     #$06
	lda     (sp),y
	iny
	ora     (sp),y
	beq     L006B
	ldy     #$13
	jsr     ldaxysp
	sta     sreg
	stx     sreg+1
	lda     regbank+4
	sta     (sreg)
	ldy     #$01
	lda     regbank+4+1
	bra     L0096
L006B:	ldy     #$13
	jsr     ldaxysp
	sta     sreg
	stx     sreg+1
	ldy     #$15
	jsr     ldaxysp
	sta     (sreg)
	ldy     #$01
	txa
L0096:	sta     (sreg),y
L0070:	ldy     #$08
	lda     (sp),y
	beq     L0073
	lda     #$0F
	jsr     __seterrno
	ldx     #$FF
	stx     sreg
	stx     sreg+1
	txa
	bra     L007B
L0073:	iny
	lda     (sp),y
	beq     L0078
	ldy     #$0D
	jsr     ldeaxysp
	jsr     negeax
	bra     L007B
L0078:	ldy     #$0D
	jsr     ldeaxysp
L007B:	pha
	ldy     #$0E
	lda     (sp),y
	sta     regbank+4
	iny
	lda     (sp),y
	sta     regbank+5
	pla
	ldy     #$16
	jmp     addysp

.endproc

