;
; File generated by cc65 v 2.17 - Git 582aa41
;
	.fopt		compiler,"cc65 v 2.17 - Git 582aa41"
	.setcpu		"6502"
	.smart		on
	.autoimport	on
	.case		on
	.debuginfo	off
	.importzp	sp, sreg, regsave, regbank
	.importzp	tmp1, tmp2, tmp3, tmp4, ptr1, ptr2, ptr3, ptr4
	.macpack	longbranch
	.import		_malloc
	.export		_realloc
	.import		_free
	.import		_memcpy
	.import		__heapptr
	.import		__heapend

; ---------------------------------------------------------------
; __near__ void * __near__ __fastcall__ realloc (__near__ void *, register unsigned int)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_realloc: near

.segment	"CODE"

	jsr     pushax
	ldy     #$00
	ldx     #$04
	jsr     regswap2
	lda     regbank+2
	ldx     regbank+3
	jsr     pushax
	jsr     decsp6
	ldy     #$0B
	lda     (sp),y
	dey
	ora     (sp),y
	bne     L0002
	lda     regbank+4
	ldx     regbank+4+1
	jsr     _malloc
	jmp     L0001
L0002:	lda     regbank+4
	ora     regbank+4+1
	bne     L0006
	iny
	jsr     ldaxysp
	jsr     _free
	ldx     #$00
	txa
	jmp     L0001
L0006:	lda     #$04
	clc
	adc     regbank+4
	sta     regbank+4
	bcc     L000E
	inc     regbank+4+1
L000E:	lda     regbank+4+1
	cmp     #$00
	bne     L0011
	lda     regbank+4
	cmp     #$06
L0011:	bcs     L000F
	ldx     #$00
	lda     #$06
	sta     regbank+4
	stx     regbank+4+1
L000F:	iny
	jsr     ldaxysp
	jsr     decax4
	ldy     #$03
	jsr     ldaxidx
	sta     regbank+2
	stx     regbank+2+1
	ldy     #$01
	lda     (regbank+2),y
	tax
	dey
	lda     (regbank+2),y
	ldy     #$02
	jsr     staxysp
	clc
	adc     regbank+2
	pha
	txa
	adc     regbank+2+1
	tax
	pla
	cpx     __heapptr+1
	bne     L0021
	cmp     __heapptr
	bne     L0021
	lda     __heapptr
	sec
	ldy     #$02
	sbc     (sp),y
	pha
	lda     __heapptr+1
	iny
	sbc     (sp),y
	tax
	pla
	clc
	adc     regbank+4
	pha
	txa
	adc     regbank+4+1
	tax
	pla
	jsr     stax0sp
	sec
	sbc     __heapend
	sta     tmp1
	txa
	sbc     __heapend+1
	ora     tmp1
	beq     L003E
	bcs     L0021
L003E:	jsr     ldax0sp
	sta     __heapptr
	stx     __heapptr+1
	lda     regbank+4
	ldy     #$00
	sta     (regbank+2),y
	iny
	lda     regbank+4+1
	sta     (regbank+2),y
	lda     regbank+2
	ldx     regbank+2+1
	iny
	sta     (regbank+2),y
	iny
	txa
	sta     (regbank+2),y
	ldy     #$0B
	jmp     L003F
L0021:	lda     regbank+4
	ldx     regbank+4+1
	jsr     _malloc
	ldy     #$04
	jsr     staxysp
	stx     tmp1
	ora     tmp1
	beq     L002B
	ldx     #$00
	lda     #$04
	ldy     #$02
	jsr     subeqysp
	lda     regbank+4
	sec
	ldy     #$02
	sbc     (sp),y
	sta     tmp1
	lda     regbank+4+1
	iny
	sbc     (sp),y
	ora     tmp1
	bcc     L0031
	beq     L0031
	jsr     ldaxysp
	sta     regbank+4
	stx     regbank+4+1
L0031:	ldy     #$07
	jsr     pushwysp
	ldy     #$0F
	jsr     pushwysp
	lda     regbank+4
	ldx     regbank+4+1
	jsr     _memcpy
	ldy     #$0B
	jsr     ldaxysp
	jsr     _free
L002B:	ldy     #$05
L003F:	jsr     ldaxysp
L0001:	pha
	stx     tmp1
	ldy     #$09
	ldx     #$03
L003C:	lda     (sp),y
	sta     regbank+2,x
	dey
	dex
	bpl     L003C
	ldx     tmp1
	pla
	ldy     #$0C
	jmp     addysp

.endproc

