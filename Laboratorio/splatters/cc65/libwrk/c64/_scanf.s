;
; File generated by cc65 v 2.17 - Git 582aa41
;
	.fopt		compiler,"cc65 v 2.17 - Git 582aa41"
	.setcpu		"6502"
	.smart		on
	.autoimport	on
	.case		on
	.debuginfo	off
	.importzp	sp, sreg, regsave, regbank
	.importzp	tmp1, tmp2, tmp3, tmp4, ptr1, ptr2, ptr3, ptr4
	.macpack	longbranch
	.import		_memset
	.import		__setjmp
	.import		_longjmp
	.import		__seterrno
	.import		_isdigit
	.import		_isspace
	.import		_isxdigit
	.import		_tolower
	.export		__scanf

.segment	"RODATA"

_Bits:
	.byte	$01
	.byte	$02
	.byte	$04
	.byte	$08
	.byte	$10
	.byte	$20
	.byte	$40
	.byte	$80

.segment	"BSS"

_format:
	.res	2,$00
_D_:
	.res	2,$00
_ap:
	.res	2,$00
_JumpBuf:
	.res	5,$00
_F:
	.res	1,$00
_CharCount:
	.res	2,$00
_C:
	.res	2,$00
_Width:
	.res	2,$00
_IntVal:
	.res	4,$00
_Assignments:
	.res	2,$00
_IntBytes:
	.res	1,$00
_Converted:
	.res	1,$00
_Positive:
	.res	1,$00
_NoAssign:
	.res	1,$00
_Invert:
	.res	1,$00
_CharSet:
	.res	32,$00

; ---------------------------------------------------------------
; int __near__ __fastcall__ _scanf (__near__ const struct scanfdata *, __near__ const unsigned char *, __near__ unsigned char *)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	__scanf: near

.segment	"RODATA"

L01B5:
	.word	$0000
L02B9:
	.word	$0000
L02C8:
	.word	$0000
L02D7:
	.word	$0000

.segment	"BSS"

L0191:
	.res	1,$00
L0192:
	.res	1,$00
L0193:
	.res	1,$00

.segment	"CODE"

	jsr     pushax
	lda     regbank+4
	ldx     regbank+5
	jsr     pushax
	ldy     #$07
	jsr     ldaxysp
	sta     _D_
	stx     _D_+1
	ldy     #$05
	jsr     ldaxysp
	sta     _format
	stx     _format+1
	ldy     #$03
	jsr     ldaxysp
	sta     _ap
	stx     _ap+1
	lda     #$00
	sta     _Converted
	sta     _Assignments
	sta     _Assignments+1
	sta     _CharCount
	sta     _CharCount+1
	lda     #<(_JumpBuf)
	ldx     #>(_JumpBuf)
	jsr     __setjmp
	cmp     #$00
	jne     L01A0
L01A3:	jsr     _ReadChar
	jmp     L01FE
L01A6:	lda     _F
	cmp     #$25
	beq     L01AA
	ldx     #$00
	jsr     _isspace
	tax
	beq     L01AC
	jsr     _SkipWhite
	jmp     L01FE
L01AC:	lda     _C
	ldx     _C+1
	jsr     pushax
	lda     _F
	jsr     tosicmp0
	beq     L01A3
	jmp     L01A0
L01AA:	jsr     _GetFormat
	cmp     #$25
	beq     L01AC
	lda     _F
	cmp     #$2A
	jsr     booleq
	sta     _NoAssign
	lda     _NoAssign
	beq     L01BE
	jsr     _GetFormat
L01BE:	lda     #$FF
	sta     _Width
	sta     _Width+1
	lda     _F
	ldx     #$00
	jsr     _isdigit
	sta     L0191
	lda     L0191
	beq     L01CB
	lda     #$00
	sta     _Width
	sta     _Width+1
L01CA:	lda     _Width
	ldx     _Width+1
	jsr     mulax10
	sta     ptr1
	stx     ptr1+1
	lda     _F
	and     #$0F
	clc
	adc     ptr1
	ldx     ptr1+1
	bcc     L0332
	inx
L0332:	sta     _Width
	stx     _Width+1
	jsr     _GetFormat
	ldx     #$00
	jsr     _isdigit
	tax
	bne     L01CA
L01CB:	lda     _Width
	ora     _Width+1
	bne     L01D2
	lda     #$07
	jsr     __seterrno
	jmp     L0339
L01D2:	lda     _Width
	ldx     _Width+1
	jsr     complax
	sta     _Width
	stx     _Width+1
	lda     #$01
	sta     _IntBytes
	lda     _F
	cmp     #$48
	beq     L01E3
	cmp     #$4A
	beq     L031F
	cmp     #$4C
	beq     L01EC
	cmp     #$54
	beq     L01F6
	cmp     #$5A
	beq     L01F6
	cmp     #$CC
	beq     L01F6
	jmp     L0320
L01E3:	lda     _format+1
	sta     ptr1+1
	lda     _format
	sta     ptr1
	ldy     #$00
	lda     (ptr1),y
	cmp     #$48
	bne     L01F6
	sty     _IntBytes
	inc     _format
	bne     L01F6
	inc     _format+1
	jmp     L01F6
L01EC:	lda     _format+1
	sta     ptr1+1
	lda     _format
	sta     ptr1
	ldy     #$00
	lda     (ptr1),y
	cmp     #$4C
	bne     L031F
	inc     _format
	bne     L031F
	inc     _format+1
L031F:	lda     #$03
	sta     _IntBytes
L01F6:	jsr     _GetFormat
L0320:	lda     _F
	cmp     #$41
	jeq     L02ED
	cmp     #$43
	jeq     L0325
	cmp     #$44
	beq     L0200
	cmp     #$45
	jeq     L02ED
	cmp     #$46
	jeq     L02ED
	cmp     #$47
	jeq     L02ED
	cmp     #$49
	beq     L0206
	cmp     #$4E
	jeq     L02DD
	cmp     #$4F
	beq     L020A
	cmp     #$50
	jeq     L02C1
	cmp     #$53
	beq     L0214
	cmp     #$55
	beq     L0200
	cmp     #$58
	beq     L020E
	cmp     #$5B
	jeq     L025E
	cmp     #$C1
	jeq     L02ED
	cmp     #$C3
	jeq     L02ED
	cmp     #$C5
	jeq     L02ED
	cmp     #$C6
	jeq     L02ED
	cmp     #$C7
	jeq     L02ED
	cmp     #$D3
	jeq     L02ED
	cmp     #$D8
	beq     L020E
	jmp     L0306
L0200:	lda     #$0A
	jsr     _ScanInt
	jmp     L01FE
L0206:	lda     #$00
	jsr     _ScanInt
	jmp     L01FE
L020A:	lda     #$08
	jsr     _ScanInt
	jmp     L01FE
L020E:	lda     #$10
	jsr     _ScanInt
	jmp     L01FE
L0214:	jsr     _SkipWhite
	jsr     _CheckEnd
	lda     #$01
	sta     _Converted
	lda     _NoAssign
	bne     L0225
	lda     _ap
	sec
	sbc     #$02
	sta     _ap
	bcs     L0222
	dec     _ap+1
L0222:	ldx     _ap+1
	jsr     ldaxi
	sta     regbank+4
	stx     regbank+4+1
	jmp     L0225
L0321:	lda     _NoAssign
	bne     L022C
	lda     regbank+4
	ldx     regbank+4+1
	sta     regsave
	stx     regsave+1
	jsr     incax1
	sta     regbank+4
	stx     regbank+4+1
	lda     _C
	ldy     #$00
	sta     (regsave),y
L022C:	jsr     _ReadChar
L0225:	lda     _C+1
	cmp     #$FF
	bne     L0333
	lda     _C
	cmp     #$FF
	beq     L0324
L0333:	lda     _C
	ldx     _C+1
	jsr     _isspace
	cmp     #$00
	bne     L0324
	inc     _Width
	bne     L022A
	inc     _Width+1
L022A:	lda     _Width
	ora     _Width+1
	bne     L0321
L0324:	lda     _NoAssign
	jne     L01FE
	tay
	sta     (regbank+4),y
	inc     _Assignments
	jne     L01FE
	inc     _Assignments+1
	jmp     L01FE
L0325:	lda     L0191
	bne     L0239
	ldx     #$FF
	lda     #$FE
	sta     _Width
	stx     _Width+1
L0239:	jsr     _CheckEnd
	lda     #$01
	sta     _Converted
	lda     _NoAssign
	bne     L0258
	lda     _ap
	sec
	sbc     #$02
	sta     _ap
	bcs     L0249
	dec     _ap+1
L0249:	ldx     _ap+1
	jsr     ldaxi
	sta     regbank+4
	stx     regbank+4+1
	jmp     L024C
L024A:	jsr     _CheckEnd
	lda     regbank+4
	ldx     regbank+4+1
	sta     regsave
	stx     regsave+1
	jsr     incax1
	sta     regbank+4
	stx     regbank+4+1
	lda     _C
	ldy     #$00
	sta     (regsave),y
	jsr     _ReadChar
L024C:	inc     _Width
	bne     L024E
	inc     _Width+1
L024E:	lda     _Width
	ora     _Width+1
	bne     L024A
	inc     _Assignments
	jne     L01FE
	inc     _Assignments+1
	jmp     L01FE
L0256:	jsr     _CheckEnd
	jsr     _ReadChar
L0258:	inc     _Width
	bne     L025A
	inc     _Width+1
L025A:	lda     _Width
	ora     _Width+1
	bne     L0256
	jmp     L01FE
L025E:	lda     #>(_CharSet)
	sta     ptr1+1
	lda     #<(_CharSet)
	sta     ptr1
	lda     #$00
	ldy     #$1F
L0318:	sta     (ptr1),y
	dey
	bpl     L0318
	jsr     _GetFormat
	cmp     #$5E
	jsr     booleq
	sta     _Invert
	lda     _Invert
	beq     L0326
	jsr     _GetFormat
L0326:	lda     _F
	cmp     #$5D
	bne     L0327
	jmp     L0275
L026F:	lda     _format+1
	sta     ptr1+1
	lda     _format
	sta     ptr1
	ldy     #$00
	lda     (ptr1),y
	cmp     #$2D
	bne     L0275
	lda     _F
	sta     L0193
	inc     _format
	bne     L027A
	inc     _format+1
L027A:	jsr     _GetFormat
	cmp     #$00
	beq     L027F
	cmp     #$5D
	bne     L0287
L027F:	lda     L0193
	jsr     _AddCharToSet
	lda     #$2D
	jsr     _AddCharToSet
	jmp     L0327
L0287:	lda     L0193
	jsr     _AddCharToSet
	lda     _F
	cmp     L0193
	beq     L031E
	inc     L0193
	jmp     L0287
L0275:	lda     _F
	jsr     _AddCharToSet
L031E:	jsr     _GetFormat
L0327:	lda     _F
	beq     L032B
	cmp     #$5D
	bne     L026F
L032B:	lda     _F
	bne     L0295
	lda     _format
	sec
	sbc     #$01
	sta     _format
	bcs     L0295
	dec     _format+1
L0295:	lda     _Invert
	beq     L0336
	jsr     _InvertCharSet
	lda     #$00
L0336:	sta     L0192
	lda     _NoAssign
	bne     L02AA
	lda     _ap
	sec
	sbc     #$02
	sta     _ap
	bcs     L02A7
	dec     _ap+1
L02A7:	ldx     _ap+1
	jsr     ldaxi
	sta     regbank+4
	stx     regbank+4+1
	jmp     L02AA
L032C:	lda     _NoAssign
	bne     L032D
	lda     regbank+4
	ldx     regbank+4+1
	sta     regsave
	stx     regsave+1
	jsr     incax1
	sta     regbank+4
	stx     regbank+4+1
	lda     _C
	ldy     #$00
	sta     (regsave),y
L032D:	lda     #$01
	sta     _Converted
	sta     L0192
	jsr     _ReadChar
L02AA:	jsr     _IsCharInSet
	tax
	beq     L0330
	inc     _Width
	bne     L02AD
	inc     _Width+1
L02AD:	lda     _Width
	ora     _Width+1
	bne     L032C
L0330:	lda     L0192
	jeq     L01A0
	lda     _NoAssign
	jne     L01FE
	tay
	sta     (regbank+4),y
	inc     _Assignments
	jne     L01FE
	inc     _Assignments+1
	jmp     L01FE
L02C1:	jsr     _SkipWhite
	lda     _C
	cmp     #$30
	jne     L01A0
	lda     #$01
	sta     _Converted
	jsr     _ReadChar
	lda     _C
	cmp     #$58
	beq     L02D1
	cmp     #$D8
	bne     L01A0
L02D1:	jsr     _ReadChar
	lda     #$10
	jsr     _ReadInt
	jsr     _AssignInt
	jmp     L01FE
L02DD:	lda     _CharCount
	ldx     _CharCount+1
	jsr     pushax
	lda     _C+1
	cmp     #$FF
	bne     L02E3
	lda     _C
	cmp     #$FF
	bne     L02E3
	lda     #$00
	jmp     L02E5
L02E3:	lda     #$01
L02E5:	jsr     tossuba0
	jsr     axulong
	sta     _IntVal
	stx     _IntVal+1
	ldy     sreg
	sty     _IntVal+2
	ldy     sreg+1
	sty     _IntVal+3
	jsr     _AssignInt
	lda     _NoAssign
	bne     L01FE
	lda     _Assignments
	sec
	sbc     #$01
	sta     _Assignments
	bcs     L01FE
	dec     _Assignments+1
	jmp     L01FE
L02ED:	lda     #$0D
	jsr     __seterrno
	jmp     L0339
L0306:	lda     #$07
	jsr     __seterrno
	jmp     L0339
L01FE:	jsr     _GetFormat
	tax
	jne     L01A6
	jmp     L030F
L01A0:	lda     _C+1
	cmp     #$FF
	bne     L030F
	lda     _C
	cmp     #$FF
	bne     L030F
	lda     _Converted
	bne     L030F
L0339:	lda     #$FF
	sta     _Assignments
	sta     _Assignments+1
L030F:	jsr     _PushBack
	lda     _Assignments
	ldx     _Assignments+1
	pha
	ldy     #$00
	lda     (sp),y
	sta     regbank+4
	iny
	lda     (sp),y
	sta     regbank+5
	pla
	jmp     incsp8

.endproc

; ---------------------------------------------------------------
; unsigned int __near__ FindBit (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_FindBit: near

.segment	"CODE"

	pha
	lsr     a
	lsr     a
	lsr     a
	tax
	pla
	and     #$07
	tay
	lda     _Bits,y
	jmp     L0010
L0010:	rts

.endproc

; ---------------------------------------------------------------
; void __near__ __fastcall__ AddCharToSet (unsigned char)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_AddCharToSet: near

.segment	"CODE"

	jsr     pusha
	jsr     _FindBit
	ora     _CharSet,x
	sta     _CharSet,x
	jmp     incsp1

.endproc

; ---------------------------------------------------------------
; unsigned char __near__ IsCharInSet (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_IsCharInSet: near

.segment	"CODE"

	lda     #$00
	ldx     _C+1
	bne     L1
	lda     _C
	jsr     _FindBit
	and     _CharSet,x
L1:	ldx     #$00
	jmp     L002D
L002D:	rts

.endproc

; ---------------------------------------------------------------
; void __near__ InvertCharSet (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_InvertCharSet: near

.segment	"CODE"

	ldy     #$1F
L1:	lda     _CharSet,y
	eor     #$FF
	sta     _CharSet,y
	dey
	bpl     L1
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ PushBack (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_PushBack: near

.segment	"CODE"

	ldx     _C+1
	bne     L0055
	lda     _C
	jsr     pusha0
	lda     _D_+1
	sta     ptr1+1
	lda     _D_
	sta     ptr1
	ldy     #$02
	lda     (ptr1),y
	sta     jmpvec+1
	iny
	lda     (ptr1),y
	sta     jmpvec+2
	ldy     #$05
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     jmpvec
	lda     _CharCount
	bne     L0083
	dec     _CharCount+1
L0083:	dec     _CharCount
L0055:	rts

.endproc

; ---------------------------------------------------------------
; void __near__ ReadChar (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_ReadChar: near

.segment	"CODE"

	lda     _D_+1
	sta     ptr1+1
	lda     _D_
	sta     ptr1
	ldy     #$00
	lda     (ptr1),y
	sta     jmpvec+1
	iny
	lda     (ptr1),y
	sta     jmpvec+2
	ldy     #$05
	lda     (ptr1),y
	tax
	dey
	lda     (ptr1),y
	jsr     jmpvec
	sta     _C
	stx     _C+1
	inx
	beq     L00BA
	inc     _CharCount
	bne     L00BA
	inc     _CharCount+1
L00BA:	rts

.endproc

; ---------------------------------------------------------------
; void __near__ __fastcall__ Error (unsigned char)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_Error: near

.segment	"CODE"

	jsr     pusha
	pha
	lda     #<(_JumpBuf)
	ldx     #>(_JumpBuf)
	jsr     pushax
	pla
	ldx     #>$0000
	jmp     _longjmp
	jsr     incsp1
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ CheckEnd (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_CheckEnd: near

.segment	"CODE"

	ldx     _C+1
	beq     L00D8
	lda     #$02
	jmp     _Error
L00D8:	rts

.endproc

; ---------------------------------------------------------------
; void __near__ SkipWhite (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_SkipWhite: near

.segment	"CODE"

	jmp     L00E0
L00DE:	jsr     _ReadChar
L00E0:	lda     _C
	ldx     _C+1
	jsr     _isspace
	tax
	bne     L00DE
	rts

.endproc

; ---------------------------------------------------------------
; void __near__ ReadSign (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_ReadSign: near

.segment	"CODE"

	lda     _C
	cmp     #'-'
	bne     L00EC
	sta     _Converted
	jsr     _ReadChar
	lda     #$00
	beq     L00F6
L00EC:	cmp     #'+'
	bne     L00FD
	sta     _Converted
	jsr     _ReadChar
L00FD:	lda     #$01
L00F6:	sta     _Positive
	rts

.endproc

; ---------------------------------------------------------------
; unsigned char __near__ __fastcall__ HexVal (unsigned char)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_HexVal: near

.segment	"CODE"

	jsr     pusha
	ldy     #$00
	lda     (sp),y
	ldx     #$00
	jsr     _isdigit
	beq     L010D
	ldx     #$00
	lda     (sp,x)
	ldy     #$30
	jmp     L033A
L010D:	ldy     #$00
	lda     (sp),y
	ldx     #$00
	jsr     _tolower
	ldx     #$00
	ldy     #$37
L033A:	jsr     decaxy
	ldx     #$00
	jmp     incsp1

.endproc

; ---------------------------------------------------------------
; void __near__ __fastcall__ ReadInt (unsigned char)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_ReadInt: near

.segment	"BSS"

L0114:
	.res	1,$00
L0115:
	.res	1,$00

.segment	"CODE"

	jsr     pusha
	lda     #$00
	sta     L0115
	sta     _IntVal
	sta     _IntVal+1
	sta     _IntVal+2
	sta     _IntVal+3
	jmp     L011B
L033C:	inc     L0115
	lda     _IntVal+3
	sta     sreg+1
	lda     _IntVal+2
	sta     sreg
	ldx     _IntVal+1
	lda     _IntVal
	jsr     pusheax
	ldy     #$04
	ldx     #$00
	lda     (sp),y
	jsr     aulong
	jsr     axulong
	jsr     tosmuleax
	jsr     pusheax
	ldx     #$00
	lda     L0114
	jsr     aulong
	jsr     axulong
	jsr     tosaddeax
	sta     _IntVal
	stx     _IntVal+1
	ldy     sreg
	sty     _IntVal+2
	ldy     sreg+1
	sty     _IntVal+3
	jsr     _ReadChar
L011B:	lda     _C
	ldx     _C+1
	jsr     _isxdigit
	tax
	beq     L033F
	inc     _Width
	bne     L011F
	inc     _Width+1
L011F:	lda     _Width
	ora     _Width+1
	beq     L033F
	lda     _C
	jsr     _HexVal
	sta     L0114
	ldy     #$00
	cmp     (sp),y
	txa
	sbc     #$00
	bcc     L033C
L033F:	lda     L0115
	bne     L0340
	lda     #$01
	jsr     _Error
L0340:	lda     #$01
	sta     _Converted
	jmp     incsp1

.endproc

; ---------------------------------------------------------------
; void __near__ AssignInt (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_AssignInt: near

.segment	"CODE"

	lda     _NoAssign
	bne     L014F
	lda     _ap
	sec
	sbc     #$02
	sta     _ap
	bcs     L0139
	dec     _ap+1
L0139:	ldx     _ap+1
	jsr     ldaxi
	sta     ptr1
	stx     ptr1+1
	ldy     _IntBytes
L0140:	lda     _IntVal,y
	sta     (ptr1),y
	dey
	bpl     L0140
	inc     _Assignments
	bne     L014F
	inc     _Assignments+1
L014F:	rts

.endproc

; ---------------------------------------------------------------
; void __near__ __fastcall__ ScanInt (unsigned char)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_ScanInt: near

.segment	"CODE"

	jsr     pusha
	jsr     _SkipWhite
	jsr     _ReadSign
	ldy     #$00
	lda     (sp),y
	bne     L0344
	lda     _C
	cmp     #$30
	bne     L0343
	jsr     _ReadChar
	lda     _C
	cmp     #$58
	beq     L0341
	cmp     #$D8
	bne     L0342
L0341:	lda     #$10
	ldy     #$00
	sta     (sp),y
	lda     #$01
	sta     _Converted
	jsr     _ReadChar
	jmp     L0174
L0342:	lda     #$08
	ldy     #$00
	sta     (sp),y
	jsr     _PushBack
	ldx     #$00
	lda     #$30
	sta     _C
	stx     _C+1
	jmp     L0174
L0343:	lda     #$0A
	sta     (sp),y
L0174:	ldy     #$00
L0344:	lda     (sp),y
	jsr     _ReadInt
	lda     _Positive
	bne     L0179
	lda     _IntVal+3
	sta     sreg+1
	lda     _IntVal+2
	sta     sreg
	ldx     _IntVal+1
	lda     _IntVal
	jsr     negeax
	sta     _IntVal
	stx     _IntVal+1
	ldy     sreg
	sty     _IntVal+2
	ldy     sreg+1
	sty     _IntVal+3
L0179:	jsr     _AssignInt
	jmp     incsp1

.endproc

; ---------------------------------------------------------------
; unsigned char __near__ GetFormat (void)
; ---------------------------------------------------------------

.segment	"CODE"

.proc	_GetFormat: near

.segment	"CODE"

	lda     _format+1
	sta     regsave+1
	lda     _format
	sta     regsave
	inc     _format
	bne     L0186
	inc     _format+1
L0186:	ldy     #0
	lda     (regsave),y
	ldx     #>$0000
	sta     _F
	rts

.endproc

